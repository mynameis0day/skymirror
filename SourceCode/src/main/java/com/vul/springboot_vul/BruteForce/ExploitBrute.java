package com.vul.springboot_vul.BruteForce;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;

@Controller
@RequestMapping("/brute")
public class ExploitBrute {
    @RequestMapping("/BruteFore")
    public String bruteFore(@RequestParam("username") String username, @RequestParam("password") String password, Model model) {
        String true_username = "administrator";
        String true_password = "administrator123";
        if (username.equals(true_username) && password.equals(true_password)) {
            model.addAttribute("msg0", "<script>alert(\"登录成功！你已成功入侵后台管理系统！\")</script>");
        } else if (!username.equals(true_username) && password.equals(true_password)) {
            model.addAttribute("msg1", "<script>alert(\"用户名错误！\")</script>");
        } else if (username.equals(true_username) && !password.equals(true_password)) {
            model.addAttribute("msg2", "<script>alert(\"密码错误！\")</script>");
        } else {
            model.addAttribute("msg3", "<script> alert(\"用户不存在！\") </script>");
        }
        return "/Vuls/BruteForceVuls/brute_result";
    }
}
